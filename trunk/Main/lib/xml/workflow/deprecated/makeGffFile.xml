<workflowGraph name="makeGffFile">

    <param name="downloadSiteDataDir"/>
    <param name="organismName"/>
    <param name="organismFullName"/>
    <param name="projectName"/>
    <param name="projectVersion"/>


    <step name="makeGffFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::RunGffDump">
      <paramValue name="outputFile">$$downloadSiteDataDir$$/$$organismName$$_$$projectName$$-$$projectVersion$$.gff</paramValue>
      <paramValue name="organismName">$$organismName$$</paramValue>
      <paramValue name="organismFullName">$$organismFullName$$</paramValue>
      <paramValue name="projectDB">$$projectName$$</paramValue>
    </step>

    <step name="copyGffFileToMercatorDataDir" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::CopyDownloadFile">
      <paramValue name="fromFile">$$downloadSiteDataDir$$/$$organismName$$_$$projectName$$-$$projectVersion$$.gff</paramValue>
      <paramValue name="toFile">common/mercator/$$organismName$$_$$projectName$$-$$projectVersion$$.gff</paramValue>
    <depends name="makeGffFile"/>
    </step>


    <step name="grepExonAndCDSFromGff" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::GrepMercatorGff">
      <paramValue name="inputFile">common/mercator/$$organismName$$_$$projectName$$-$$projectVersion$$.gff</paramValue>
      <paramValue name="outputFile">common/mercator/$$organismName$$_$$projectName$$-$$projectVersion$$.gff.in</paramValue>
    <depends name="makeGffFile"/>
    </step>

    <step name="correctReadingFrameInGff" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::FixMercatorOffsetsInGFF">
      <paramValue name="inputFile">common/mercator/$$organismName$$_$$projectName$$-$$projectVersion$$.gff.in</paramValue>
      <paramValue name="fsaFile">common/mercator/$$organismName$$BlockedMixedGenomicSeq.fsa</paramValue>
      <paramValue name="outputFile">common/mercator/$$organismName$$_$$projectName$$-$$projectVersion$$.gff</paramValue>
    <depends name="grepExonAndCDSFromGff"/>
    </step>

</workflowGraph>
