
 <workflowGraph name="">
  <param name="parentDataDir"/>
  <param name="datasetLoaderXmlFileName"/>

  <constant name="dataDir">$$parentDataDir$$/metadata</constant>

  <step name="makeDataDir" stepClass="ReFlow::StepClasses::MakeDataDir">
    <paramValue name="dataDir">$$dataDir$$</paramValue>
  </step>

  <step name="manuallyImproveIsolatesVocabulary" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::DoNothingStep">
    <depends name="makeDataDir"/>
  </step>

  <datasetTemplate class="ontologyTerms">
    <prop name="name"/>
    <prop name="version"/>
    <subgraph name="${name}_OntologyTerms_RSRC" xmlFile="loadDataset.xml">
      <paramValue name="datasetName">OntologyTerm_${name}_RSRC</paramValue>
      <paramValue name="datasetLoaderXmlFileName">$$datasetLoaderXmlFile$$</paramValue>
      <paramValue name="parentDataDir">$$dataDir$$</paramValue>
      <depends name="manuallyImproveIsolatesVocabulary"/>
    </subgraph>
  </datasetTemplate>

<datasetTemplate class="projectSpecificOntologyTerms">
    <prop name="name"/>
    <prop name="version"/>
    <prop name="projectName"/>
    <subgraph name="${name}_projectSpecificOntologyTerms_RSRC" xmlFile="loadDataset.xml">
      <paramValue name="datasetName">OntologyTerm_${projectName}_${name}_RSRC</paramValue>
      <paramValue name="datasetLoaderXmlFileName">$$datasetLoaderXmlFileName$$</paramValue>
      <paramValue name="parentDataDir">$$dataDir$$</paramValue>
    </subgraph>
  </datasetTemplate>


  <datasetTemplate class="isolateGeographicLocationGPS">
    <subgraph name="geographicLocationGPS_RSRC" xmlFile="loadDataset.xml">
      <paramValue name="datasetName">geographicLocationGPS_RSRC</paramValue>
      <paramValue name="datasetLoaderXmlFileName">$$datasetLoaderXmlFile$$</paramValue>
      <paramValue name="parentDataDir">$$dataDir$$</paramValue>
      <dependsPattern name="*OntologyTerms*"/>
    </subgraph>
  </datasetTemplate>

  <datasetTemplate class="isolateQualifierToVocabMapping">
    <subgraph name="isolateVocabularyMap_RSRC" xmlFile="loadDataset.xml">
      <paramValue name="datasetName">isolateVocabularyMap_RSRC</paramValue>
      <paramValue name="datasetLoaderXmlFileName">$$datasetLoaderXmlFile$$</paramValue>
      <paramValue name="parentDataDir">$$dataDir$$</paramValue>
      <dependsPattern name="*OntologyTerms*"/>
    </subgraph>
  </datasetTemplate>

  <datasetTemplate class="proteinMicroarrayMetaData">
    <prop name="organismAbbrev"/>
    <prop name="experimentName"/>
    <prop name="experimentVersion"/>

      <subgraph name="${experimentName}_microarrayAntibody_insertMetaData" xmlFile="loadSampleMetaData.xml">
        <paramValue name="organismAbbrev">${organismAbbrev}</paramValue>
        <paramValue name="parentDataDir"></paramValue>
        <paramValue name="experimentName">${experimentName}</paramValue>
        <paramValue name="sampleExtDbRlsSpecTemplate"></paramValue>
        <paramValue name="studyExtDbRlsSpec">${organismAbbrev}_microarrayAntibody_${experimentName}_RSRC|${experimentVersion}</paramValue>
        <paramValue name="isProfile">true</paramValue>
        <paramValue name="dataType">immuneResponse</paramValue>
        <paramValue name="datasetLoaderXmlFileName">$$datasetLoaderXmlFileName$$</paramValue>
      <dependsPattern name="*projectSpecificOntologyTerms*"/>
      </subgraph>

  </datasetTemplate>

  <datasetTemplate class="SnpMetaData">
    <prop name="organismAbbrev"/>
    <prop name="experimentName"/>
    <prop name="experimentVersion"/>

      <subgraph name="${organismAbbrev}_${experimentName}_SNP_insertMetaData" xmlFile="loadSampleMetaData.xml">
        <paramValue name="organismAbbrev">${organismAbbrev}</paramValue>
        <paramValue name="parentDataDir"></paramValue>
        <paramValue name="experimentName">${experimentName}</paramValue>
        <paramValue name="readsFile"></paramValue>
        <paramValue name="sampleExtDbRlsSpecTemplate">${organismAbbrev}_${experimentName}_@SAMPLE_NAME@_HTS_SNPSample_RSRC|dontcare</paramValue>
        <paramValue name="studyExtDbRlsSpec">${organismAbbrev}_HTS_SNP_${experimentName}_RSRC|${experimentVersion}</paramValue>
        <paramValue name="isProfile"></paramValue>
        <paramValue name="dataType">SNP</paramValue>
        <paramValue name="datasetLoaderXmlFileName">$$datasetLoaderXmlFileName$$</paramValue>
      <dependsPattern name="*projectSpecificOntologyTerms*"/>
      </subgraph>
  </datasetTemplate>

  <datasetTemplate class="SNPChipMetaData">
    <prop name="organismAbbrev"/>
    <prop name="experimentName"/>
    <prop name="experimentVersion"/>

      <subgraph name="${experimentName}_SNPChip_insertMetaData" xmlFile="loadSampleMetaData.xml">
        <paramValue name="organismAbbrev">${organismAbbrev}</paramValue>
        <paramValue name="parentDataDir"></paramValue>
        <paramValue name="experimentName">${experimentName}</paramValue>
        <paramValue name="readsFile">0</paramValue>
        <paramValue name="sampleExtDbRlsSpecTemplate"></paramValue> 
        <paramValue name="studyExtDbRlsSpec">${organismAbbrev}_SNPChip_${experimentName}_RSRC|${experimentVersion}</paramValue>
        <paramValue name="isProfile"></paramValue>
        <paramValue name="dataType">SNPChip</paramValue>
        <paramValue name="datasetLoaderXmlFileName">$$datasetLoaderXmlFileName$$</paramValue>
      <dependsPattern name="*projectSpecificOntologyTerms*"/>
      </subgraph>
  </datasetTemplate>

  <datasetTemplate class="chipChipMetaData">
    <prop name="organismAbbrev"/>
    <prop name="experimentName"/>
    <prop name="experimentVersion"/>

      <subgraph name="${experimentName}_ChipChip_insertMetaData" xmlFile="loadSampleMetaData.xml">
        <paramValue name="organismAbbrev">${organismAbbrev}</paramValue>
        <paramValue name="parentDataDir"></paramValue>
        <paramValue name="experimentName">${experimentName}</paramValue>
        <paramValue name="readsFile"></paramValue>
        <paramValue name="sampleExtDbRlsSpecTemplate">${organismAbbrev}_${experimentName}_@SAMPLE_NAME@_chipChipSample_RSRC</paramValue>
        <paramValue name="studyExtDbRlsSpec">${organismAbbrev}_ChipChip_${experimentName}_RSRC|${experimentVersion}</paramValue>
        <paramValue name="isProfile">true</paramValue>
        <paramValue name="dataType">chip-chip</paramValue>
        <paramValue name="datasetLoaderXmlFileName">$$datasetLoaderXmlFileName$$</paramValue>
      <dependsPattern name="*projectSpecificOntologyTerms*"/>
      </subgraph>
  </datasetTemplate>

  <datasetTemplate class="copyNumberVariationMetaData">
    <prop name="organismAbbrev"/>
    <prop name="experimentName"/>
    <prop name="experimentVersion"/>

      <subgraph name="${organismAbbrev}_${experimentName}_CopyNumberVariation_insertMetaData" xmlFile="loadSampleMetaData.xml">
        <paramValue name="organismAbbrev">${organismAbbrev}</paramValue>
        <paramValue name="parentDataDir"></paramValue>
        <paramValue name="experimentName">${experimentName}</paramValue>
        <paramValue name="readsFile"></paramValue>
        <paramValue name="sampleExtDbRlsSpecTemplate">${organismAbbrev}_${experimentName}_@SAMPLE_NAME@_copyNumberVariationSample_RSRC|dontcare</paramValue>
        <paramValue name="studyExtDbRlsSpec">${organismAbbrev}_copyNumberVariations_${experimentName}_RSRC|${experimentVersion}</paramValue>
        <paramValue name="isProfile"></paramValue>
        <paramValue name="dataType">copyNumberVariation</paramValue>
        <paramValue name="datasetLoaderXmlFileName">$$datasetLoaderXmlFileName$$</paramValue>
      <dependsPattern name="*projectSpecificOntologyTerms*"/>
      </subgraph>
  </datasetTemplate>



</workflowGraph>
