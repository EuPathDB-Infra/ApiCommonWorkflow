<workflowGraph name="">
    <param name="parentDataDir"/>
    <param name="substanceIdsFile"/>
    <param name="compoundIdsFile"/>

    <constant name="dataDir">$$parentDataDir$$</constant>
    <step name="makeDataDir" stepClass="ReFlow::StepClasses::MakeDataDir">
      <paramValue name="dataDir">$$dataDir$$</paramValue>
    </step>

    <!-- extract CID data in XML from PubChem for  Substances  -->
    <step name="extractPubChemSubstances_CID" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::ExtractPubChemData">
     <paramValue name="idFile">$$dataDir$$/${substanceIdsFile}</paramValue>
     <paramValue name="outFile">$$dataDir$$/substance_cids.xml</paramValue>
     <paramValue name="type">pcsubstance</paramValue>
     <paramValue name="property">CID</paramValue>
    <depends name="makeDataDir"/>
  </step>

    <!-- insert CID data for Substances  -->
     <step name="insertPubChemSubstances_CID" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::InsertPubChemSubstances" stepLoadTypes="plugin">
      <paramValue name="fileDir">$$dataDir$$</paramValue>
      <paramValue name="fileNames">substance_cids.xml</paramValue>
      <paramValue name="compoundIdsFile">$$dataDir$$/${compoundIdsFile}</paramValue>
     <paramValue name="property">CID</paramValue>
    <depends name="extractPubChemSubstances_CID"/>
  </step>

    <!-- extract Synonym data in XML from PubChem for  Substances  -->
    <step name="extractPubChemSubstances_synonyms" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::ExtractPubChemData">
     <paramValue name="idFile">$$dataDir$$/${substanceIdsFile}</paramValue>
     <paramValue name="outFile">$$dataDir$$/substance_synonyms.xml</paramValue>
     <paramValue name="type">pcsubstance</paramValue>
     <paramValue name="property">Synonym</paramValue>
    <depends name="makeDataDir"/>
  </step>

    <!-- insert Synonym data for Substances  -->
     <step name="insertPubChemSubstances_synonyms" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::InsertPubChemSubstances" stepLoadTypes="plugin">
      <paramValue name="fileDir">$$dataDir$$</paramValue>
      <paramValue name="fileNames">substance_synonyms.xml</paramValue>
     <paramValue name="property">Synonym</paramValue>
    <depends name="extractPubChemSubstances_synonyms"/>
  </step>


  <!-- extract properties data XML from PubChem for  Compounds  -->
    <step name="extractPubChemCompounds" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::ExtractPubChemData">
     <paramValue name="idFile">$$dataDir$$/${compoundIdsFile}</paramValue>
     <paramValue name="outFile">$$dataDir$$/compounds.xml</paramValue>
     <paramValue name="type">pccompound</paramValue>
    <depends name="insertPubChemSubstances_synonyms"/>
  </step>

  <!-- insert Compounds  -->
     <step name="insertPubChemCompounds" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::InsertPubChemCompounds" stepLoadTypes="plugin">
      <paramValue name="fileDir">$$dataDir$$</paramValue>
      <paramValue name="fileNames">$$dataDir$$/compounds.xml</paramValue>
    <depends name="extractPubChemCompounds"/>
  </step>


    <step name="document-compounds"
          stepClass="ApiCommonWorkflow::Main::WorkflowSteps::InsertAnalysisMethodInvocation">
      <paramValue name="method">compounds_MTHD</paramValue>
      <paramValue name="version">1.0</paramValue>
      <paramValue name="parameters">TODO: patch in later</paramValue>
    </step>

</workflowGraph>
