<workflowGraph name="analyzeNGSSNPSample">
    <param name="parentDataDir"/>
    <param name="sampleName"/>
    <param name="shortSeqsFile"/>
    <param name="rnaSeqExtDbRlsSpec"/>
    <param name="genomeExtDbSpec"/>
    <param name="genomicSeqsFile"/>
    <param name="pairedReadFilePath"/>
    <param name="reference_strain"/>
    <param name="BowtieIndexDir"/>
    <param name="organismFullName"/>
    <param name="bowtieParam"/>
    <param name="inputShortSeqsFileType"/>

    <constant name="dataDir">$$parentDataDir$$/analyze$$sampleName$$</constant>

    <step name="makeDataDir" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDataDir">
      <paramValue name="dataDir">$$dataDir$$</paramValue>
    </step>

     <step name="runBowtie" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::SsaRunBowtie">
      <paramValue name="inputShortSeqsFile">$$shortSeqsFile$$</paramValue>
      <paramValue name="pairedReadFilePath">$$pairedReadFilePath$$</paramValue>
      <paramValue name="inputIndexesDir">$$BowtieIndexDir$$</paramValue>
      <paramValue name="bowtieParam">$$bowtieParam$$</paramValue>
      <paramValue name="inputShortSeqsFileType">$$inputShortSeqsFileType$$</paramValue>
      <paramValue name="outputFile">$$dataDir$$/SNPs.sam</paramValue>
      <depends name="makeDataDir"/>
    </step>

     <step name="makeSortedBAMFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeSortedBAMFile">
      <paramValue name="inputFile">$$dataDir$$/SNPs.sam</paramValue>
      <paramValue name="outputFile">$$dataDir$$/SNPs.bam</paramValue>
      <depends name="runBowtie"/>
    </step>

    <step name="identifySNPsFromBamFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::IdentifySNPsFromBamFile">
      <paramValue name="genomicSeqsFile">$$genomicSeqsFile$$</paramValue>
      <paramValue name="bamFile">$$dataDir$$/RUM_NU.all.sorted</paramValue>
      <paramValue name="outputFile">$$dataDir$$/SNPs.snps</paramValue>
      <depends name="makeSortedBAMFile"/>
    </step>

    <step name="parseVarscanToGff" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::ParseVarscanToGff">
      <paramValue name="inputFile">$$dataDir$$/SNPs.snps</paramValue>
      <paramValue name="strain">$$reference_strain$$</paramValue>
      <paramValue name="outputFile">$$dataDir$$/SNPs.gff</paramValue>
    </step>

    <step name="insertSnps" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::InsertSnpMummer" stepLoadTypes="plugin">
      <paramValue name="inputFile">$$dataDir$$/SNPs.gff</paramValue>
      <paramValue name="strain">$$reference_strain$$</paramValue>
      <paramValue name="organismFullName">$$organismFullName$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbSpec$$</paramValue>
      <paramValue name="transcriptExtDbRlsSpec">$$genomeExtDbSpec$$</paramValue>
      <paramValue name="snpExtDbRlsSpec">$$rnaSeqExtDbRlsSpec$$</paramValue>
      <paramValue name="NGS_SNP">true</paramValue>
      <depends name="parseVarscanToGff"/>
    </step>

</workflowGraph>


