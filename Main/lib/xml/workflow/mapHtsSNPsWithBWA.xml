<workflowGraph name="">
    <param name="parentDataDir"/>
    <param name="organismAbbrev"/>
    <param name="name"/>
    <param name="shortSeqsFile"/>
    <param name="snpExtDbRlsSpec"/>
    <param name="genomeExtDbRlsSpec"/>
    <param name="genomicSeqsFile"/>
    <param name="hasPairedReads"/>
    <param name="pairedReadFile"/>
    <param name="snpStrain"/>
    <param name="BWAIndexDir"/>
    <param name="isHaploid"/>

    <constant name="dataDir">$$parentDataDir$$/$$name$$</constant>

    <step name="makeDataDir" stepClass="ReFlow::StepClasses::MakeDataDir">
      <paramValue name="dataDir">$$dataDir$$</paramValue>
    </step>

     <step name="runBWA" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::RunBWA">
      <paramValue name="genomicSeqsFile">$$genomicSeqsFile$$</paramValue>
      <paramValue name="inputShortSeqsFile">$$shortSeqsFile$$</paramValue>
      <paramValue name="pairedReadFile">$$pairedReadFile$$</paramValue>
      <paramValue name="hasPairedReads">$$hasPairedReads$$</paramValue>
      <paramValue name="outputFile">$$dataDir$$/SNPs</paramValue>
      <paramValue name="inputIndexesDir">$$BWAIndexDir$$</paramValue>
      <paramValue name="strain">$$snpStrain$$</paramValue>
      <paramValue name="isHaploid">$$isHaploid$$</paramValue>
      <depends name="makeDataDir"/>
    </step>

    <step name="document-HTS_snps_bwa"
          stepClass="ApiCommonWorkflow::Main::WorkflowSteps::InsertAnalysisMethodInvocation">
      <paramValue name="method">HTS_snps_bwa_MTHD</paramValue>
      <paramValue name="version">1.0</paramValue>
      <paramValue name="parameters">TODO: patch in later</paramValue>
    </step>

    <step name="insertSnps" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::InsertSnpMummer" stepLoadTypes="plugin">
      <paramValue name="inputFile">$$dataDir$$/SNPs.gff</paramValue>
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="transcriptExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="snpExtDbRlsSpec">$$snpExtDbRlsSpec$$</paramValue>
      <paramValue name="isNextGenSeq">true</paramValue>
      <depends name="runBWA"/>
    </step>

</workflowGraph>


