<workflowGraph name="">
    <param name="organismAbbrev"/>
    <param name="parentDataDir"/>
    <param name="experimentName"/>
    <param name="sampleExtDbRlsSpecTemplate"/>
    <param name="studyExtDbRlsSpec"/>
    <param name="isProfile"/>
    <param name="dataType"/>
    <param name="datasetLoaderXmlFileName"/>

    <constant name="datasetName">$$organismAbbrev$$_$$dataType$$_metaData_$$experimentName$$_RSRC</constant>
    <constant name="dataDir">$$parentDataDir$$/$$organismAbbrev$$_$$experimentName$$</constant>

    <step name="makeDataDir" stepClass="ReFlow::StepClasses::MakeDataDir">
      <paramValue name="dataDir">$$dataDir$$</paramValue>
   </step>

   <subgraph name="getMetaData" xmlFile="loadDataset.xml">
      <paramValue name="datasetName">$$datasetName$$</paramValue>
      <paramValue name="datasetLoaderXmlFileName">$$datasetLoaderXmlFileName$$</paramValue>
      <paramValue name="parentDataDir">$$dataDir$$</paramValue>
      <depends name="makeDataDir"/>
    </subgraph>

<!--
    <step name="addStudy" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::InsertStudy" stepLoadTypes="plugin">
      <paramValue name="experimentName">$$organismAbbrev$$_$$dataType$$_$$experimentName$$</paramValue>
      <paramValue name="experimentExtDbRlsSpec">$$studyExtDbRlsSpec$$</paramValue>
      <depends name="getMetaData"/>
    </step>
-->
    <step name="addMetaData" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::InsertStudyMetaData" stepLoadTypes="plugin">
     <paramValue name="experimentName">$$organismAbbrev$$_$$dataType$$_$$experimentName$$</paramValue>
     <paramValue name="sampleMetaDataFile">$$dataDir$$/$$datasetName$$/metadata/sampleMetaData.txt</paramValue> 
     <paramValue name="sampleExtDbRlsSpecTemplate">$$sampleExtDbRlsSpecTemplate$$</paramValue>
     <paramValue name="studyExtDbRlsSpec">$$studyExtDbRlsSpec$$</paramValue>
     <paramValue name="isProfile">$$isProfile$$</paramValue>
     <depends name="addStudy"/>
    </step>

</workflowGraph>
