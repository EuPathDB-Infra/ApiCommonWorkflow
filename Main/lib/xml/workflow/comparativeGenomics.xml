<workflowGraph name="comparativeGenomics">
    <param name="parentDataDir"/>
    <param name="mercatorDraftGenomes"/>
    <param name="mercatorNonDraftGenomes"/>
    <param name="mercatorDraftExternalDbSpec"/>
    <param name="mercatorNonDraftExternalDbSpec"/>
    <param name="mercatorDraftSeqTables"/>
    <param name="mercatorNonDraftSeqTables"/>
    <param name="cndSrcBin"/>
    <param name="mavidExe"/>
    <param name="projectName"/>
    <param name="mercatorFastaDir"/>
    <param name="mercatorGffDir"/>
    <param name="webServicesDataDir"/>
    <param name="organismResourceXmlFile"/>
    <param name="commonResourceXmlFile"/>
    <param name="orthoMCLPhyleticProfilesResourceName"/>
    <param name="orthoMCLOrthologousGroupsResourceName"/>

    <constant name="mercatorDataDir">$$parentDataDir$$/mercator</constant>

    <step name="makeMercatorDataDir" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDataDir">
      <paramValue name="dataDir">$$mercatorDataDir$$</paramValue>
    </step>

    <step name="createPairwiseMercatorDirs" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::CreatePairwiseMercatorDirs">
      <paramValue name="mercatorDir">$$mercatorDataDir$$</paramValue>
      <paramValue name="mercatorFastaDir">$$mercatorFastaDir$$</paramValue>
      <paramValue name="mercatorGffDir">$$mercatorGffDir$$</paramValue>
      <paramValue name="mercatorDraftGenomes">$$mercatorDraftGenomes$$</paramValue>
      <paramValue name="mercatorNonDraftGenomes">$$mercatorNonDraftGenomes$$</paramValue>
      <paramValue name="mercatorDraftExternalDbSpec">$$mercatorDraftExternalDbSpec$$</paramValue>
      <paramValue name="mercatorNonDraftExternalDbSpec">$$mercatorNonDraftExternalDbSpec$$</paramValue>
      <paramValue name="mercatorDraftSeqTables">$$mercatorDraftSeqTables$$</paramValue>
      <paramValue name="mercatorNonDraftSeqTables">$$mercatorNonDraftSeqTables$$</paramValue>
      <paramValue name="mercatorSyntenyVersion">@@mercatorSyntenyVersion@@</paramValue>    
      <depends name="makeDataDir"/>
    </step>

    <step name="runPairwiseMercatorMavid" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::RunPairwiseMercatorMavid">
      <paramValue name="mercatorDir">$$mercatorDataDir$$</paramValue>
      <paramValue name="mercatorDraftGenomes">$$mercatorDraftGenomes$$</paramValue>
      <paramValue name="mercatorNonDraftGenomes">$$mercatorNonDraftGenomes$$</paramValue>
      <paramValue name="cndSrcBin">$$cndSrcBin$$</paramValue>
      <paramValue name="mavidExe">$$mavidExe$$</paramValue>
      <depends name="createPairwiseMercatorDirs"/>
    </step>

  <subgraph name="RodentPlasmodiumChromosomes_RSRC" xmlFile="loadResource.xml">
    <paramValue name="resourceName">RodentPlasmodiumChromosomes_RSRC</paramValue>
    <paramValue name="resourceXmlFileName">$$commonResourceXmlFile$$</paramValue>
    <paramValue name="parentDataDir">$$dataDir$$</paramValue>
    <depends name="runPairwiseMercatorMavid"/> 
  </subgraph>

  <subgraph name="loadOrthoMCLPhyleticProfiles" xmlFile="loadResource.xml">
    <paramValue name="resourceName">$$orthoMCLPhyleticProfilesResourceName$$</paramValue>
    <paramValue name="resourceXmlFileName">$$organismResourceXmlFile$$</paramValue>
    <paramValue name="parentDataDir">$$parentDataDir$$</paramValue>
    <depends name="makeDataDir"/> 
  </subgraph>

  <subgraph name="loadOrthoMCLOrthologousGroups" xmlFile="loadResource.xml">
    <paramValue name="resourceName">$$orthoMCLOrthologousGroupsResourceName$$</paramValue>
    <paramValue name="resourceXmlFileName">$$organismResourceXmlFile$$</paramValue>
    <paramValue name="parentDataDir">$$parentDataDir$$</paramValue>
    <depends name="loadOrthoMCLPhyleticProfiles"/> 
  </subgraph>

  <step name="runTuningManager"
          stepClass="ApiCommonWorkflow::Main::WorkflowSteps::RunTuningManager">
      <depends name="loadOrthoMCLOrthologousGroups"/> 
  </step>

    <step name="insertPairwiseSyntenyAnchors" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::InsertPairwiseSyntenyAnchors" stepLoadTypes="plugin">
      <paramValue name="mercatorDir">$$mercatorDataDir</paramValue>
      <paramValue name="organism">$$projectName$$</paramValue>
      <paramValue name="mercatorDraftGenomes">$$mercatorDraftGenomes$$</paramValue>
      <paramValue name="mercatorNonDraftGenomes">$$mercatorNonDraftGenomes$$</paramValue>
      <depends name="runPairwiseMercatorMavid"/>
      <depends name="runTuningManager"/>
    </step>

    <step name="copyPairwiseMercatorDirsToWebserviceDir" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::CopyPairwiseMercatorDirsToWebserviceDir">
      <paramValue name="mercatorDir">$$mercatorDataDir$$</paramValue>
      <paramValue name="apiSiteFilesDir">$$webServicesDataDir$$/mercator</paramValue>
      <depends name="runPairwiseMercatorMavid"/>
    </step>

</workflowGraph>
