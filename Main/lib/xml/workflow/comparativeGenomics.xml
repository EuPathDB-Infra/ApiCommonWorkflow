<workflowGraph name="comparativeGenomics">
    <param name="parentDataDir"/>
    <param name="mercatorFastaDir"/>
    <param name="mercatorGffDir"/>
    <param name="relativeWebServicesDir"/>
    <param name="organismSpecificCreateGenesForGeneFeatures"/>
    <param name="createGenesForGeneFeatures"/>

    <constant name="mercatorDataDir">$$parentDataDir$$/mercator_pairwise</constant>

    <step name="makeMercatorDataDir" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDataDir">
      <paramValue name="dataDir">$$mercatorDataDir$$</paramValue>
    </step>

    <step name="createPairwiseMercatorDirs" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::CreatePairwiseMercatorDirs">
      <paramValue name="mercatorDir">$$mercatorDataDir$$</paramValue>
      <paramValue name="mercatorFastaDir">$$mercatorFastaDir$$</paramValue>
      <paramValue name="mercatorGffDir">$$mercatorGffDir$$</paramValue>

      <paramValue name="mercatorSyntenyVersion">@@mercatorSyntenyVersion@@</paramValue>    
      <depends name="makeMercatorDataDir"/>
    </step>

    <step name="runPairwiseMercatorMavid" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::RunPairwiseMercatorMavid">
      <paramValue name="mercatorDir">$$mercatorDataDir$$</paramValue>
      <depends name="createPairwiseMercatorDirs"/>
    </step>

  <subgraph name="OrthoMCL_Phyletic_RSRC" xmlFile="loadResource.xml">
    <paramValue name="resourceName">OrthoMCL_Phyletic_RSRC</paramValue>
    <paramValue name="resourceXmlFileName">common.xml</paramValue>
    <paramValue name="parentDataDir">$$parentDataDir$$/common/comparativeGenomics</paramValue>
  </subgraph>

  <subgraph name="OrthoMCL_RSRC" xmlFile="loadResource.xml">
    <paramValue name="resourceName">OrthoMCL_RSRC</paramValue>
    <paramValue name="resourceXmlFileName">common.xml</paramValue>
    <paramValue name="parentDataDir">$$parentDataDir$$/common/comparativeGenomics</paramValue>
    <depends name="OrthoMCL_Phyletic_RSRC"/> 
  </subgraph>

  <subgraph name="OrthoMCLTree_RSRC" xmlFile="loadResource.xml">
    <paramValue name="resourceName">OrthoMCLTree_RSRC</paramValue>
    <paramValue name="resourceXmlFileName">common.xml</paramValue>
    <paramValue name="parentDataDir">$$parentDataDir$$/common/comparativeGenomics</paramValue>
  </subgraph>

  <step name="runTuningManager"
          stepClass="ApiCommonWorkflow::Main::WorkflowSteps::RunTuningManager">
      <depends name="OrthoMCL_RSRC"/> 
  </step>

    <step name="insertPairwiseSyntenyAnchors" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::InsertPairwiseSyntenyAnchors" stepLoadTypes="plugin">
      <paramValue name="mercatorDir">$$mercatorDataDir$$</paramValue>
      <paramValue name="mercatorSyntenyVersion">dontcare</paramValue>   
      <depends name="runPairwiseMercatorMavid"/>
      <depends name="runTuningManager"/>
    </step>

    <step name="copyPairwiseMercatorDirsToWebserviceDir" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::CopyPairwiseMercatorDirsToWebserviceDir">
      <paramValue name="mercatorDir">$$mercatorDataDir$$</paramValue>
      <paramValue name="relativeWebServicesDir">$$relativeWebServicesDir$$</paramValue>
      <depends name="runPairwiseMercatorMavid"/>
    </step>

  <subgraph name="organismSpecificCreateGenesForGeneFeatures" xmlFile="$$organismSpecificCreateGenesForGeneFeatures$$" includeIf="$$createGenesForGeneFeatures$$">
    <paramValue name="mercatorDataDir">$$mercatorDataDir$$</paramValue>
    <paramValue name="parentDataDir">$$parentDataDir$$</paramValue>
    <depends name="runPairwiseMercatorMavid"/>
  </subgraph>

</workflowGraph>
