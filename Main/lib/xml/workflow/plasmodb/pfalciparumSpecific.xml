<workflowGraph name="pfalciparumSpecificAnalysis">
  <param name="parentDataDir"/>
  <param name="organismName"/>
  <param name="organismFullName"/>
  <param name="genomeExtDbRlsSpec"/>
  <param name="suSnpExtDbRlsSpec"/>
  <param name="broadSnpExtDbRlsSpec"/>
  <param name="winzelerSnpExtDbRlsSpec"/>
  <param name="sangerItGhanaSnpExtDbRlsSpec"/>
  <param name="sangerReichenowiSnpExtDbRlsSpec"/>
  <param name="combinedSnpExtDbRlsSpec"/>
  <param name="sageTagExtDbRlsSpec"/>
  <param name="oligoExtDbRlsSpec"/>
  <param name="genbankIsolateExtDbRlsSpec"/>
  <param name="stunnenberChipProbeFile"/>
  <param name="stunnenberChipExtDbRlsSpec"/>
  <param name="stunnenberChipInputDir"/>
  <param name="scherfChipProbeFile"/>
  <param name="scherfChipExtDbRlsSpec"/>
  <param name="scherfChipInputDir"/>
  <param name="vossChipProbeFile"/>
  <param name="vossChipExtDbRlsSpec"/>
  <param name="vossChipInputDir"/>
  <param name="organismResourceXmlFile"/>


  <constant name="dataDir">$$parentDataDir$$/$$organismName$$Specific</constant>
  <constant name="genomicSeqsFile">$$parentDataDir$$/$$organismName$$/genome/genomicSeqs.fsa</constant>
  <constant name="genbankIsolateSeqFile">$$dataDir$$/genbankIsolatesSeqs.fsa</constant>
    <constant name="organismResourceXmlFile">global</constant>

  <step name="makeDataDir" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDataDir">
    <paramValue name="dataDir">$$dataDir$$</paramValue>
  </step>


    <subgraph name="mapIsolatesToGenome" xmlFile="pfalciparumMapIsolatesToGenome.xml">
      <paramValue name="parentDataDir"></paramValue>
      <paramValue name="organismName"></paramValue>
      <paramValue name="genomeExtDbRlsSpec"></paramValue>
      <paramValue name="genbankIsolateExtDbRlsSpec"></paramValue>
      <depends name="mirrorToCluster"/>
    </subgraph>

    <subgraph name="SNPs" xmlFile="pfalciparumSNPs.xml">
      <paramValue name="parentDataDir"></paramValue>
      <paramValue name="organismName"></paramValue>
      <paramValue name="organismFullName"></paramValue>
      <paramValue name="genomeExtDbRlsSpec"></paramValue>
      <paramValue name="suSnpExtDbRlsSpec"></paramValue>
      <paramValue name="broadSnpExtDbRlsSpec"></paramValue>
      <paramValue name="winzelerSnpExtDbRlsSpec"></paramValue>
      <paramValue name="sangerItGhanaSnpExtDbRlsSpec"></paramValue
      <paramValue name="sangerReichenowiSnpExtDbRlsSpec"></paramValue>
      <paramValue name="combinedSnpExtDbRlsSpec"></paramValue>
      <paramValue name="organismResourceXmlFile">plasmodb/pfalciparum.xml</paramValue>
      <depends name="mirrorToCluster"/>
    </subgraph>

  <subgraph name="mapSageTags" xmlFile="mapSageTags.xml">
    <paramValue name="genomicSeqsFile">$$genomicSeqsFile$$</paramValue>
    <paramValue name="parentDataDir">$$dataDir$$</paramValue>
    <paramValue name="sageTagExtDbRlsSpec">$$sageTagExtDbRlsSpec$$</paramValue>
    <paramValue name="studyName">Transcriptional profile of P.falciparum by Serial analysis of gene expression</paramValue>
    <paramValue name="nickName">mapSageTags</paramValue> 
    <paramValue name="paramValue">25372</paramValue>    
    <paramValue name="calFreq">true</paramValue>
    <depends name="makeDataDir"/>
  </subgraph>


  <subgraph name="mapOligos" xmlFile="mapOligos.xml">
    <paramValue name="parentDataDir">$$dataDir$$</paramValue>
    <paramValue name="oligoExtDbRlsSpec">$$oligoExtDbRlsSpec$$</paramValue>
    <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
    <paramValue name="genomicSeqsFile">$$genomicSeqsFile$$</paramValue>
    <paramValue name="idRegex">(\\S+)\\s+length</paramValue>
    <paramValue name="loadOptions">--hspMatchLength 64 --hspPctIdent 95 --hspsLimit 1</paramValue>
    <depends name="makeDataDir"/>
  </subgraph>

  <step name="loadAnticodons" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::LoadAnticodons">
     <paramValue name="inputFileRelativeToManualDeliveryDir">anticodons/PfAntiCodons</paramValue>
     <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
  </step>



  <subgraph name="stunnenberChIP" xmlFile="ChIP-chip.xml">
    <paramValue name="parentDataDir">$$dataDir$$</paramValue>
    <paramValue name="chipNickName">stunnenberChIP-chip</paramValue>
    <paramValue name="genomicSeqsFile">$$genomicSeqsFile$$</paramValue>
    <paramValue name="probeFile">$$stunnenberChipProbeFile$$</paramValue>
    <paramValue name="chipExtDbRlsSpec">$$stunnenberChipExtDbRlsSpec$$</paramValue>
    <paramValue name="inputDir">$$stunnenberChipInputDir$$</paramValue>
    <depends name="makeDataDir"/>
  </subgraph>

  <subgraph name="scherfChIP" xmlFile="ChIP-chip.xml">
    <paramValue name="parentDataDir">$$dataDir$$</paramValue>
    <paramValue name="chipNickName">scherfChIP-chip</paramValue>
    <paramValue name="genomicSeqsFile">$$genomicSeqsFile$$</paramValue>
    <paramValue name="probeFile">$$scherfChipProbeFile$$</paramValue>
    <paramValue name="chipExtDbRlsSpec">$$scherfChipExtDbRlsSpec$$</paramValue>
    <paramValue name="inputDir">$$scherfChipInputDir$$</paramValue>
    <depends name="makeDataDir"/>
  </subgraph>

  <subgraph name="vossChIP" xmlFile="ChIP-chip.xml">
    <paramValue name="parentDataDir">$$dataDir$$</paramValue>
    <paramValue name="chipNickName">vossChIP-chip</paramValue>
    <paramValue name="genomicSeqsFile">$$genomicSeqsFile$$</paramValue>
    <paramValue name="probeFile">$$vossChipProbeFile$$</paramValue>
    <paramValue name="chipExtDbRlsSpec">$$vossChipExtDbRlsSpec$$</paramValue>
    <paramValue name="inputDir">$$vossChipInputDir$$</paramValue>
    <depends name="makeDataDir"/>
  </subgraph>
 
</workflowGraph>
