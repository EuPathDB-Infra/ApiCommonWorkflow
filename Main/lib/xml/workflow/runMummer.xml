<workflowGraph name="runMummer">

    <param name="parentDataDir"/>
    <param name="snpNickName"/>
    <param name="genomicSeqsFile"/>
    <param name="organismFullName"/>
    <param name="genomeExtDbRlsSpec"/>
    <param name="snpExtDbRlsSpec"/>
    <param name="resourcesFile"/>
    <param name="strain"/>

    <constant name="dataDir">$$parentDataDir$$/$$snpNickName$$</constant>

    <step name="makeDataDir" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDataDir">
      <paramValue name="dataDir">$$dataDir$$</paramValue>
    </step>

    <step name="copySnpGffFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::CopyResourcesFile">
      <paramValue name="resourcesFile">$$resourcesFile$$</paramValue>
      <paramValue name="toFile">$$dataDir$$/SNPs.gff</paramValue>
      <depends name="makeDataDir"/>
    </step>

    <step name="snpGffToFasta" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::SnpGffToFasta">
      <paramValue name="inputFile">$$dataDir$$/SNPs.gff</paramValue>
      <paramValue name="outputFile">$$dataDir$$/SNPs.fasta</paramValue>
      <paramValue name="strain">$$strain$$</paramValue>
      <depends name="copySnpGffFile"/>
    </step>

    <step name="runMummer" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::RunMummer">
      <paramValue name="genomicSeqsFile">$$genomicSeqsFile$$</paramValue>
      <paramValue name="inputDir">$$dataDir$$</paramValue>
      <paramValue name="outputFile">$$dataDir$$/SNPsMummer.out</paramValue>
      <depends name="snpGffToFasta"/>
    </step>

    <step name="snpMummerToGff" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::SnpMummerToGff">
      <paramValue name="inputFile">$$dataDir$$/SNPsMummer.out</paramValue>
      <paramValue name="gffFile">$$dataDir$$/SNPs.gff</paramValue>
      <paramValue name="outputFile">$$dataDir$$/SNPsMummer.gff</paramValue>
      <paramValue name="strain">$$strain$$</paramValue>
      <depends name="runMummer"/>
    </step>

    <step name="insertSnpMummer" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::InsertSnpMummer" stepLoadTypes="insertSnpMummer,plugin">
      <paramValue name="inputFile">$$dataDir$$/SNPsMummer.gff</paramValue>
      <paramValue name="strain">$$strain$$</paramValue>
      <paramValue name="organismFullName">$$organismFullName$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="transcriptExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="snpExtDbRlsSpec">$$snpExtDbRlsSpec$$</paramValue>
      <depends name="snpMummerToGff"/>
    </step>

</workflowGraph>
