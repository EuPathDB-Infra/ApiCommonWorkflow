<workflowGraph name="analyzeRnaSeqSample">
    <param name="parentDataDir"/>
    <param name="sampleName"/>
    <param name="genomicSeqsFile"/>
    <param name="transcriptsSeqsFile"/>
    <param name="geneModelFile"/>
    <param name="shortSeqsFile"/>
    <param name="outputCoverageFile"/>
    <param name="outputIntensityFile"/>
    <param name="readType"/>

    <constant name="dataDir">$$parentDataDir$$/analyze$$sampleName$$</constant>
    <constant name="uniqueFile">uniqueMappings</constant>
    <constant name="nonUniqueFile">nonUniqueMappings</constant>

    <step name="makeDataDir" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDataDir">
      <paramValue name="dataDir">$$dataDir$$</paramValue>
    </step>

    <subgraph name="alignReadsToGenome"  xmlFile="ssa.xml">
      <paramValue name="parentDataDir">$$dataDir$$</paramValue>
      <paramValue name="genomicSeqsFile">$$genomicSeqsFile$$</paramValue>
      <paramValue name="transcriptsSeqsFile">$$transcriptsSeqsFile$$</paramValue>
      <paramValue name="useTranscripts">true</paramValue>
      <paramValue name="shortSeqsFile">$$shortSeqsFile$$</paramValue>
      <paramValue name="outputUniqueFile">$$uniqueFile$$</paramValue>
      <paramValue name="outputNonUniqueFile">$$nonUniqueFile$$</paramValue>
      <paramValue name="isChipSeq">false</paramValue>
      <paramValue name="readType">$$readType$$</paramValue>
      <depends name="makeDataDir"/>
    </step>

    <step name="makeAndNormalizeCoverageFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::SsaMakeAndNormalizeCoverageFile">
      <paramValue name="inputUniqueFile">$$uniqueFile$$</paramValue>
      <paramValue name="outputFile">$$outputCoverageFile$$</paramValue>
      <paramValue name="sampleName">$$sampleName$$</paramValue>
      <depends name="alignReadsToGenome"/>
    </step>

    <step name="makeIntensityFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeIntensityFile">
      <paramValue name="inputCoverageFile">$$outputCoverageFile$$</paramValue>
      <paramValue name="inputGeneModelFile">$$geneModelFile$$</paramValue>
      <paramValue name="outputIntensityFile">$$outputIntensityFile$$</paramValue>
      <depends name="makeCoverageFile"/>
    </step>

</workflowGraph>
