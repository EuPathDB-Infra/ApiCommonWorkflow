<workflowGraph name="toxoSpecificMakeAndFormatDownloadFiles">

    <param name="downloadSiteDataDir"/>
    <param name="projectName"/>
    <param name="projectVersion"/>
    <param name="webServicesDataDir"/>
    <param name="genbankIsolateExtDbRlsSpec"/>
    <param name="sibleyIsolateExtDbRlsSpec"/>

    <step name="makeGenbankIsolateDownloadFile" stepClass="ApiCommonData::Load::WorkflowSteps::MakeIsolateDownloadFile">
      <paramValue name="outputFile">$$downloadSiteDataDir$$/ToxoGenbankIsolates_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="isolateExtDbRlsSpec">$$genbankIsolateExtDbRlsSpec$$</paramValue>
    </step>

    <step name="makeSibleyIsolateDownloadFile" stepClass="ApiCommonData::Load::WorkflowSteps::MakeIsolateDownloadFile">
      <paramValue name="outputFile">$$downloadSiteDataDir$$/ToxoSibleyIsolates_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="isolateExtDbRlsSpec">$$barcodeIsolateExtDbRlsSpec$$</paramValue>
    </step>

    <step name="concatenateIsolateDownloadFiles" stepClass="ApiCommonData::Load::WorkflowSteps::CatDownloadFiles">
      <paramValue name="outputFileRelativeToDownloadsDir">$$downloadSiteDataDir$$/ToxoDBIsolates_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="inputDirRelativeToDownloadsDir">$$downloadSiteDataDir$$</paramValue>
      <paramValue name="inputFileNameRegex">Isolate</paramValue>
      <paramValue name="inputFileNameExtension">fasta</paramValue>
      <depends name="makeGenbankIsolateDownloadFile"/>
      <depends name="makeSibleyIsolateDownloadFile"/>
    </step>

    <step name="formatIsolateDownloadFile" stepClass="ApiCommonData::Load::WorkflowSteps::FormatDownloadFile">
      <paramValue name="inputFile">$$downloadSiteDataDir$$/ToxoDBIsolates_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="outputDir">$$webServicesDataDir$$/blast</paramValue>
      <paramValue name="formattedFileName">ToxoDBIsolates</paramValue>
      <paramValue name="args">-n -t release-$$projectVersion$$/ToxoDBIsolates</paramValue>
      <depends name="concatenateIsolateDownloadFiles"/>
    </step>

   <subgraph name="createFullRecordCacheAndFileForIsolate" xmlFile="createFullRecordCacheAndFile.xml">
    <paramValue name="downloadSiteDataDir">$$downloadSiteDataDir$$</paramValue>
    <paramValue name="organismName">Toxo</paramValue>
    <paramValue name="organismFullName"></paramValue>
    <paramValue name="projectName">$$projectName$$</paramValue>
    <paramValue name="projectVersion">$$projectVersion$$</paramValue>
    <paramValue name="recordType">Isolate</paramValue>
    <paramValue name="deprecated">$$deprecated$$</paramValue>
    <depends name="makeDownloadSiteDataDir"/>

</workflowGraph>
