<workflowGraph name="makeAndFormatDownloadFiles">
    <param name="relativeDownloadSiteDir"/>
    <param name="organismAbbrev"/>
    <param name="genomeSource"/>
    <param name="projectName"/>
    <param name="projectVersion"/>
    <param name="dbESTExtDbRlsSpec"/>
    <param name="genomeExtDbRlsSpec"/>
    <param name="genomeVirtualSeqsExtDbRlsSpec"/>
    <param name="minOrfLength"/>
    <param name="deprecated"/>
    <param name="soTermIdsOrNames"/>
    <param name="makeESTDownloadFile"/>
    <param name="makeProteomeDownloadFile"/>
    <param name="makeGenomicDownloadFile"/>

    <constant name="ESTDescripString">EST sequences (NT)</constant>
    <constant name="dotsAssemblyDescripString">Predicted transcript sequences (NT) based on EST assemblies</constant>
    <constant name="annotatedCDSDescripString">Protein coding portion of spliced transcript sequences (NT)</constant>
    <constant name="annotatedTranscriptsDescripString">Transcript sequences (NT), including CDS and UTRs</constant>
    <constant name="annotatedProteinsDescripString">Protein sequences (AA)</constant>
    <constant name="mixedGenomicDescripString">Genomic DNA sequences (NT)</constant>
    <constant name="orfDescripString">Translated open reading frames from genomic sequences (AA)</constant>
    <constant name="orfNADescripString">Open reading frames on genomic sequences (NT)</constant>
    <constant name="interproDescripString">Interpro domains mapped to genes</constant>
    <constant name="codonDescripString">Codon usage</constant>
    <constant name="geneDescripString">Gene annotation and information in detail</constant>
    <constant name="sequenceDescripString">Genomic DNA sequence statistics and information in detail</constant>
    <constant name="gffDescripString">Genome sequences and annotations in GFF3 format</constant>

    <step name="makeESTDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeESTDownloadFile" includeIf="$$makeESTDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">fasta</paramValue>
      <paramValue name="dataName">ESTs</paramValue>
      <paramValue name="descripString">$$ESTdescripString$$</paramValue>
    </step>

    <step name="formatESTDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeWebServicesBlastFiles" includeIf="$$makeESTDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDownloadSiteDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="relativeWebServicesDir">$$relativeWebServicesDir$$</paramValue>
      <paramValue name="dataName">ESTs</paramValue>
      <paramValue name="args">-n</paramValue>
    <depends name="makeESTDownloadFile"/>
    </step>

    <step name="makeDotsAssemblyDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDotsAssemblyDownloadFile" includeIf="$$makeESTDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">fasta</paramValue>
      <paramValue name="dataName">TranscriptAssemblies</paramValue>
      <paramValue name="descripString">$$dotsAssemblyDescripString$$</paramValue>
    </step>

    <step name="formatDotsAssemblyDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeWebServicesBlastFiles" includeIf="$$makeESTDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDownloadSiteDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="relativeWebServicesDir">$$relativeWebServicesDir$$</paramValue>
      <paramValue name="dataName">TranscriptAssemblies</paramValue>
      <paramValue name="args">-n</paramValue>
    <depends name="makeDotsAssemblyDownloadFile"/>
    </step>

    <step name="makeAnnotatedCDSDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeAnnotatedCDSDownloadFile" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">fasta</paramValue>
      <paramValue name="dataName">AnnotatedCDSs</paramValue>
      <paramValue name="descripString">$$annotatedCDSDescripString$$</paramValue>
      <paramValue name="organismSource">$$genomeSource$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="genomeVirtualSeqsExtDbRlsSpec">$$genomeVirtualSeqsExtDbRlsSpec$$</paramValue>
      <paramValue name="deprecated">$$deprecated$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
    </step>

    <step name="formatAnnotatedCDSDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeWebServicesBlastFiles" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDownloadSiteDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="relativeWebServicesDir">$$relativeWebServicesDir$$</paramValue>
      <paramValue name="dataName">AnnotatedCDSs</paramValue>
      <paramValue name="args">-n</paramValue>
    <depends name="makeAnnotatedCDSDownloadFile"/>
    </step>

    <step name="makeAnnotatedTranscriptsDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeAnnotatedTranscriptsDownloadFile" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">fasta</paramValue>
      <paramValue name="dataName">AnnotatedTranscripts</paramValue>
      <paramValue name="descripString">$$annotatedTranscriptsDescripString$$</paramValue>
      <paramValue name="organismSource">$$genomeSource$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="genomeVirtualSeqsExtDbRlsSpec">$$genomeVirtualSeqsExtDbRlsSpec$$</paramValue>
      <paramValue name="deprecated">$$deprecated$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
    </step>

    <step name="formatAnnotatedTranscriptDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeWebServicesBlastFiles" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDownloadSiteDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="relativeWebServicesDir">$$relativeWebServicesDir$$</paramValue>
      <paramValue name="dataName">AnnotatedTranscripts</paramValue>
      <paramValue name="args">-n</paramValue>
    <depends name="makeAnnotatedTranscriptsDownloadFile"/>
    </step>

    <step name="makeAnnotatedProteinsDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeAnnotatedProteinsDownloadFile" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">fasta</paramValue>
      <paramValue name="dataName">AnnotatedProteins</paramValue>
      <paramValue name="descripString">$$annotatedProteinsDescripString$$</paramValue>
      <paramValue name="organismSource">$$genomeSource$$</paramValue>
      <paramValue name="deprecated">$$deprecated$$</paramValue>
      <paramValue name="genomeExtDbSpecList">$$genomeExtDbRlsSpec$$,$$genomeVirtualSeqsExtDbRlsSpec$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
    </step>

    <step name="formatAnnotatedProteinsDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeWebServicesBlastFiles" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDownloadSiteDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="relativeWebServicesDir">$$relativeWebServicesDir$$</paramValue>
      <paramValue name="dataName">AnnotatedProteins</paramValue>
      <paramValue name="args">-p -C X</paramValue>
    <depends name="makeAnnotatedProteinsDownloadFile"/>
    </step>

    <step name="makeMixedGenomicDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeMixedGenomicDownloadFile" includeIf="$$makeGenomicDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">fasta</paramValue>
      <paramValue name="dataName">Genome</paramValue>
      <paramValue name="descripString">$$mixedGenomicDescripString$$</paramValue>
      <paramValue name="organismSource">$$genomeSource$$</paramValue>
      <paramValue name="genomeExtDbSpecList">$$genomeExtDbRlsSpec$$,$$genomeVirtualSeqsExtDbRlsSpec$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
    </step>

    <step name="formatMixedGenomicDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeWebServicesBlastFiles" includeIf="$$makeGenomicDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDownloadSiteDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="relativeWebServicesDir">$$relativeWebServicesDir$$</paramValue>
      <paramValue name="dataName">Genome</paramValue>
      <paramValue name="args">-n</paramValue>
    <depends name="makeMixedGenomicDownloadFile"/>
    </step>

    <step name="makeDoubleStrandGenomicDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeGenomicDoubleStrandFile" includeIf="$$makeGenomicDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">fasta</paramValue>
      <paramValue name="dataName">GenomeDoubleStrand</paramValue>
      <paramValue name="descripString">$$mixedGenomicDescripString$$</paramValue>
      <paramValue name="organismSource">$$genomeSource$$</paramValue>
      <paramValue name="genomeExtDbSpecList">$$genomeExtDbRlsSpec$$,$$genomeVirtualSeqsExtDbRlsSpec$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
    </step>

    <step name="makeOrfDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeOrfDownloadFile" includeIf="$$makeGenomicDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">fasta</paramValue>
      <paramValue name="dataName">ORFs_AA</paramValue>
      <paramValue name="descripString">$$orfDescripString$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="genomeVirtualSeqsExtDbRlsSpec">$$genomeVirtualSeqsExtDbRlsSpec$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
      <paramValue name="minOrfLength">$$minOrfLength$$</paramValue>
    </step>

    <step name="formatOrfDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeWebServicesBlastFiles" includeIf="$$makeGenomicDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDownloadSiteDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="relativeWebServicesDir">$$relativeWebServicesDir$$</paramValue>
      <paramValue name="dataName">ORFs_AA</paramValue>
      <paramValue name="args">-p -C X</paramValue>
    <depends name="makeOrfDownloadFile"/>
    </step>

    <step name="makeOrfNADownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeOrfNADownloadFile" includeIf="$$makeGenomicDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">fasta</paramValue>
      <paramValue name="dataName">ORFs_NA</paramValue>
      <paramValue name="descripString">$$orfNADescripString$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="genomeVirtualSeqsExtDbRlsSpec">$$genomeVirtualSeqsExtDbRlsSpec$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
      <paramValue name="minOrfLength">$$minOrfLength$$</paramValue>
    </step>

    <step name="makeInterproDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeInterproDownloadFile" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">txt</paramValue>
      <paramValue name="dataName">InterproDomains</paramValue>
      <paramValue name="descripString">$$interproDescripString$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="interproExtDbRlsSpec">InterproscanData_RSRC|@@InterproscanData_VER@@</paramValue>
      <paramValue name="projectDB">$$projectName$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
    </step>

    <step name="makeCodonUsage" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeCodonUsage" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="inputFile">$$downloadSiteFastaDataDir$$/$$organismNameForFiles$$AnnotatedCDS_$$projectName$$-$$projectVersion$$.fasta</paramValue>    
      <paramValue name="descripFile">$$downloadSiteTxtDataDir$$/.$$organismNameForFiles$$AnnotatedCDS_$$projectName$$-$$projectVersion$$.fasta.desc</paramValue>    
      <paramValue name="descripString">$$codonDescripString$$</paramValue>    
      <paramValue name="outputFile">$$downloadSiteTxtDataDir$$/$$organismNameForFiles$$CodonUsage_$$projectName$$-$$projectVersion$$.txt</paramValue>
    <depends name="makeAnnotatedCDSDownloadFile"/>
    </step>

    <step name="makeGeneDescripFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDescripFile">
      <paramValue name="descripFile">$$downloadSiteTxtDataDir$$/.$$organismNameForFiles$$Gene_$$projectName$$-$$projectVersion$$.txt.desc</paramValue>    
      <paramValue name="descripString">$$geneDescripString$$</paramValue>    
    </step>

    <step name="makeSequenceDescripFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDescripFile">
      <paramValue name="descripFile">$$downloadSiteTxtDataDir$$/.$$organismNameForFiles$$Sequence_$$projectName$$-$$projectVersion$$.txt.desc</paramValue>    
      <paramValue name="descripString">$$sequenceDescripString$$</paramValue>    
    </step>

    <step name="makeGffDescripFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDescripFile">
      <paramValue name="descripFile">$$downloadSiteTxtDataDir$$/.$$organismNameForFiles$$_$$projectName$$-$$projectVersion$$.gff.desc</paramValue>    
      <paramValue name="descripString">$$gffDescripString$$</paramValue>    
    </step>


    <step name="makeReadMeFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeReadMeFile">
      <paramValue name="baseDir">$$downloadSiteDataDir$$/$$organismNameForFiles$$</paramValue>    
      <paramValue name="outputFile">$$downloadSiteDataDir$$/$$organismNameForFiles$$/README.htaccess</paramValue>    
    <depends name="makeAnnotatedCDSDownloadFile"/>
    <depends name="makeESTDownloadFile"/>
    <depends name="makeDotsAssemblyDownloadFile"/>
    <depends name="makeAnnotatedCDSDownloadFile"/>
    <depends name="makeAnnotatedTranscriptsDownloadFile"/>
    <depends name="makeAnnotatedProteinsDownloadFile"/>
    <depends name="makeMixedGenomicDownloadFile"/>
    <depends name="makeOrfDownloadFile"/>
    <depends name="makeOrfNADownloadFile"/>
    <depends name="makeInterproDownloadFile"/>
    <depends name="makeCodonUsage"/>
    <depends name="makeGeneAliasDescripFile"/>
    <depends name="makeGeneDescripFile"/>
    <depends name="makeSequenceDescripFile"/>
    <depends name="makeGffDescripFile"/>
    </step>

</workflowGraph>
