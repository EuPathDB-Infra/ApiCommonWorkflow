<workflowGraph name="makeAndFormatDownloadFiles">
    <param name="relativeDownloadSiteDir"/>
    <param name="relativeWebServicesDir"/>
    <param name="organismAbbrev"/>
    <param name="genomeSource"/>
    <param name="projectName"/>
    <param name="projectVersion"/>
    <param name="genomeExtDbRlsSpec"/>
    <param name="minOrfLength"/>
    <param name="hasDeprecatedGenes"/>
    <param name="genomeTopLevelSoTerms"/>
    <param name="isAnnotatedGenome"/>
    <param name="skipGenomeAnalysis"/>
    <param name="mapAssemblySeqsAndAssemblies"/>

    <constant name="dotsAssemblyDescripString">Predicted transcript sequences (NT) based on EST assemblies</constant>
    <constant name="annotatedCDSDescripString">Protein coding portion of spliced transcript sequences (NT)</constant>
    <constant name="annotatedTranscriptsDescripString">Transcript sequences (NT), including CDS and UTRs</constant>
    <constant name="annotatedProteinsDescripString">Protein sequences (AA)</constant>
    <constant name="mixedGenomicDescripString">Genomic DNA sequences (NT)</constant>
    <constant name="orfDescripString">Translated open reading frames from genomic sequences (AA)</constant>
    <constant name="orfNADescripString">Open reading frames on genomic sequences (NT)</constant>
    <constant name="interproDescripString">Interpro domains mapped to genes</constant>
    <constant name="codonDescripString">Codon usage</constant>
    <constant name="geneDescripString">Gene annotation and information in detail</constant>
    <constant name="sequenceDescripString">Genomic DNA sequence statistics and information in detail</constant>
    <constant name="gffDescripString">Genome sequences and annotations in GFF3 format</constant>
    <constant name="annotatedCDSsDataName">AnnotatedCDSs</constant>

    <step name="makeDotsAssemblyDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDotsAssemblyDownloadFile" includeIf="$$mapAssemblySeqsAndAssemblies$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">fasta</paramValue>
      <paramValue name="dataName">TranscriptAssemblies</paramValue>
      <paramValue name="descripString">$$dotsAssemblyDescripString$$</paramValue>
    </step>

    <step name="formatDotsAssemblyDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeWebServicesBlastFiles" includeIf="$$mapAssemblySeqsAndAssemblies$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDownloadSiteDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="relativeWebServicesDir">$$relativeWebServicesDir$$</paramValue>
      <paramValue name="dataName">TranscriptAssemblies</paramValue>
      <paramValue name="args">-n</paramValue>
      <depends name="makeDotsAssemblyDownloadFile"/>
    </step>

    <subgraph name="annotationFiles" xmlFile="makeAndFormatAnnotDownloadFiles.xml" includeIf="$$isAnnotatedGenome$$">
      <paramValue name="relativeDownloadSiteDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="relativeWebServicesDir">$$relativeWebServicesDir$$</paramValue>
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="genomeSource">$$genomeSource$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="isDeprecatedGenes">false</paramValue>
      <paramValue name="genomeTopLevelSoTerms">$$genomeTopLevelSoTerms$$</paramValue>
      <paramValue name="annotatedCDSDescripString">$$annotatedCDSDescripString$$</paramValue>
      <paramValue name="annotatedTranscriptsDescripString">$$annotatedTranscriptsDescripString$$</paramValue>
      <paramValue name="annotatedProteinsDescripString">$$annotatedProteinsDescripString$$</paramValue>
      <paramValue name="geneDescripString">$$geneDescripString$$</paramValue>
      <paramValue name="annotatedCDSsDataName">$$annotatedCDSsDataName$$</paramValue>
    </subgraph>

    <subgraph name="deprecatedAnnotationFiles" xmlFile="makeAndFormatAnnotDownloadFiles.xml" includeIf="$$hasDeprecatedGenes$$">
      <paramValue name="relativeDownloadSiteDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="relativeWebServicesDir">$$relativeWebServicesDir$$</paramValue>
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="genomeSource">$$genomeSource$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="isDeprecatedGenes">true</paramValue>
      <paramValue name="genomeTopLevelSoTerms">$$genomeTopLevelSoTerms$$</paramValue>
      <paramValue name="annotatedCDSDescripString">$$annotatedCDSDescripString$$</paramValue>
      <paramValue name="annotatedTranscriptsDescripString">$$annotatedTranscriptsDescripString$$</paramValue>
      <paramValue name="annotatedProteinsDescripString">$$annotatedProteinsDescripString$$</paramValue>
      <paramValue name="geneDescripString">$$geneDescripString$$</paramValue>
      <paramValue name="annotatedCDSsDataName">$$annotatedCDSsDataName$$</paramValue>
    </subgraph>

    <step name="makeMixedGenomicDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeMixedGenomicDownloadFile" excludeIf="$$skipGenomeAnalysis$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">fasta</paramValue>
      <paramValue name="dataName">Genome</paramValue>
      <paramValue name="descripString">$$mixedGenomicDescripString$$</paramValue>
      <paramValue name="organismSource">$$genomeSource$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$genomeTopLevelSoTerms$$</paramValue>
    </step>

    <step name="formatMixedGenomicDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeWebServicesBlastFiles" excludeIf="$$skipGenomeAnalysis$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDownloadSiteDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="relativeWebServicesDir">$$relativeWebServicesDir$$</paramValue>
      <paramValue name="dataName">Genome</paramValue>
      <paramValue name="args">-n</paramValue>
      <depends name="makeMixedGenomicDownloadFile"/>
    </step>

    <step name="makeDoubleStrandGenomicDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeGenomicDoubleStrandFile" excludeIf="$$skipGenomeAnalysis$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">fasta</paramValue>
      <paramValue name="dataName">GenomeDoubleStrand</paramValue>
      <paramValue name="descripString">$$mixedGenomicDescripString$$</paramValue>
      <paramValue name="organismSource">$$genomeSource$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$genomeTopLevelSoTerms$$</paramValue>
    </step>

    <step name="copyDoubleStrandGenomicMotifFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeWebServicesMotifFastaFile" excludeIf="$$skipGenomeAnalysis$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDownloadSiteDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="relativeWebServicesDir">$$relativeWebServicesDir$$</paramValue>
      <paramValue name="dataName">GenomeDoubleStrand</paramValue>
      <depends name="makeDoubleStrandGenomicDownloadFile"/>
    </step>

    <step name="makeOrfDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeOrfDownloadFile" excludeIf="$$skipGenomeAnalysis$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">fasta</paramValue>
      <paramValue name="dataName">ORFs_AA</paramValue>
      <paramValue name="descripString">$$orfDescripString$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$genomeTopLevelSoTerms$$</paramValue>
      <paramValue name="minOrfLength">$$minOrfLength$$</paramValue>
    </step>

    <step name="formatOrfDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeWebServicesBlastFiles" excludeIf="$$skipGenomeAnalysis$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDownloadSiteDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="relativeWebServicesDir">$$relativeWebServicesDir$$</paramValue>
      <paramValue name="dataName">ORFs_AA</paramValue>
      <paramValue name="args">-p -C X</paramValue>
      <depends name="makeOrfDownloadFile"/>
    </step>

    <step name="copyOrfsMotifFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeWebServicesMotifFastaFile" excludeIf="$$skipGenomeAnalysis$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDownloadSiteDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="relativeWebServicesDir">$$relativeWebServicesDir$$</paramValue>
      <paramValue name="dataName">ORFs_AA</paramValue>
      <depends name="makeOrfDownloadFile"/>
    </step>


    <step name="makeOrfNADownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeOrfNADownloadFile" excludeIf="$$skipGenomeAnalysis$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">fasta</paramValue>
      <paramValue name="dataName">ORFs_NA</paramValue>
      <paramValue name="descripString">$$orfNADescripString$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$genomeTopLevelSoTerms$$</paramValue>
      <paramValue name="minOrfLength">$$minOrfLength$$</paramValue>
    </step>

    <step name="makeInterproDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeInterproDownloadFile" includeIf="$$isAnnotatedGenome$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">txt</paramValue>
      <paramValue name="dataName">InterproDomains</paramValue>
      <paramValue name="descripString">$$interproDescripString$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="interproExtDbRlsSpec">InterproscanData_RSRC|@@InterproscanData_VER@@</paramValue>
      <paramValue name="projectDB">$$projectName$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$genomeTopLevelSoTerms$$</paramValue>
    </step>

    <step name="makeCodonUsage" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeCodonUsage" includeIf="$$isAnnotatedGenome$$">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">txt</paramValue>
      <paramValue name="dataName">CodonUsage</paramValue>
      <paramValue name="descripString">$$interproDescripString$$</paramValue>
      <paramValue name="inputDataName">$$annotatedCDSsDataName$$</paramValue>
      <depends name="annotationFiles"/>
    </step>

    <step name="makeSequenceDescripFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDescripFile">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">txt</paramValue>
      <paramValue name="dataName">Sequences</paramValue>
      <paramValue name="descripString">$$sequenceDescripString$$</paramValue>
    </step>

    <step name="makeGffDescripFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDescripFile">
      <paramValue name="organismAbbrev">$$organismAbbrev$$</paramValue>
      <paramValue name="projectVersion">$$projectVersion$$</paramValue>
      <paramValue name="projectName">$$projectName$$</paramValue>
      <paramValue name="relativeDir">$$relativeDownloadSiteDir$$</paramValue>
      <paramValue name="fileType">gff</paramValue>
      <paramValue name="dataName"></paramValue>
      <paramValue name="descripString">$$gffDescripString$$</paramValue>
    </step>

</workflowGraph>
