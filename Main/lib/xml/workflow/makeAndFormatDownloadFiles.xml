<workflowGraph name="makeAndFormatDownloadFiles">
    <param name="downloadSiteDataDir"/>
    <param name="organismName"/>
    <param name="organismFullName"/>
    <param name="ncbiTaxonId"/>
    <param name="parentNcbiTaxonId"/>
    <param name="genomeSource"/>
    <param name="projectName"/>
    <param name="projectVersion"/>
    <param name="dbESTExtDbRlsSpec"/>
    <param name="webServicesDataDir"/>
    <param name="genomeExtDbRlsSpec"/>
    <param name="genomeVirtualSeqsExtDbRlsSpec"/>
    <param name="minOrfLength"/>
    <param name="deprecated"/>
    <param name="makeESTDownloadFile"/>
    <param name="makeProteomeDownloadFile"/>
    <param name="makeGenomicDownloadFile"/>
    <param name="soTermIdsOrNames"/>

    <constant name="downloadSiteFastaDataDir">$$downloadSiteDataDir$$/fasta</constant>
    <constant name="downloadSiteTxtDataDir">$$downloadSiteDataDir$$/txt</constant>
    <constant name="downloadSiteGffDataDir">$$downloadSiteDataDir$$/gff</constant>
    <constant name="downloadSiteTranscriptExpressionDataDir">$$downloadSiteDataDir$$/transcriptExpression</constant>
    <constant name="ESTDescripString">EST sequences (NT)</constant>
    <constant name="dotsAssemblyDescripString">Predicted transcript sequences (NT) based on EST assemblies</constant>
    <constant name="annotatedCDSDescripString">Protein coding portion of spliced transcript sequences (NT)</constant>
    <constant name="annotatedTranscriptsDescripString">Transcript sequences (NT), including CDS and UTRs</constant>
    <constant name="annotatedProteinsDescripString">Protein sequences (AA)</constant>
    <constant name="mixedGenomicDescripString">Genomic DNA sequences (NT)</constant>
    <constant name="orfDescripString">Translated open reading frames from genomic sequences (AA)</constant>
    <constant name="orfNADescripString">Open reading frames on genomic sequences (NT)</constant>
    <constant name="interproDescripString">Interpro domains mapped to genes</constant>
    <constant name="codonDescripString">Codon usage</constant>
    <constant name="geneAliasDescripString">Current, old, and alternative gene ids</constant>
    <constant name="geneDescripString">Gene annotation and information in detail</constant>
    <constant name="sequenceDescripString">Genomic DNA sequence statistics and information in detail</constant>
    <constant name="gffDescripString">Genome sequences and annotations in GFF3 format</constant>

    <step name="makeESTDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeESTDownloadFile" includeIf="$$makeESTDownloadFile$$">
      <paramValue name="outputFile">$$downloadSiteFastaDataDir$$/$$organismName$$EST_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="descripFile">$$downloadSiteFastaDataDir$$/.$$organismName$$EST_$$projectName$$-$$projectVersion$$.fasta.desc</paramValue>
      <paramValue name="descripString">$$ESTDescripString$$</paramValue>
      <paramValue name="useTaxonHierarchy">true</paramValue>
      <paramValue name="parentNcbiTaxonId">$$parentNcbiTaxonId$$</paramValue>
    </step>

    <step name="formatESTDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::FormatDownloadFile" includeIf="$$makeESTDownloadFile$$">
      <paramValue name="inputFile">$$downloadSiteFastaDataDir$$/$$organismName$$EST_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="outputDir">$$webServicesDataDir$$/blast</paramValue>
      <paramValue name="formattedFileName">$$organismName$$EST</paramValue>
      <paramValue name="args">-n -t release-$$projectVersion$$/$$organismName$$EST</paramValue>
    <depends name="makeESTDownloadFile"/>
    </step>


    <step name="makeDotsAssemblyDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDotsAssemblyDownloadFile" includeIf="$$makeESTDownloadFile$$">
      <paramValue name="outputFile">$$downloadSiteFastaDataDir$$/$$organismName$$Assembly_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="descripFile">$$downloadSiteFastaDataDir$$/.$$organismName$$Assembly_$$projectName$$-$$projectVersion$$.fasta.desc</paramValue>
      <paramValue name="descripString">$$dotsAssemblyDescripString$$</paramValue>
      <paramValue name="ncbiTaxonId">$$ncbiTaxonId$$</paramValue>
    </step>


    <step name="formatDotsAssemblyDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::FormatDownloadFile" includeIf="$$makeESTDownloadFile$$">
      <paramValue name="inputFile">$$downloadSiteFastaDataDir$$/$$organismName$$Assembly_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="outputDir">$$webServicesDataDir$$/blast</paramValue>
      <paramValue name="formattedFileName">$$organismName$$Assemblies</paramValue>
      <paramValue name="args">-n -t release-$$projectVersion$$/$$organismName$$Assemblies</paramValue>
    <depends name="makeDotsAssemblyDownloadFile"/>
    </step>

    <step name="makeAnnotatedCDSDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeAnnotatedCDSDownloadFile" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="outputFile">$$downloadSiteFastaDataDir$$/$$organismName$$AnnotatedCDS_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="descripFile">$$downloadSiteFastaDataDir$$/.$$organismName$$AnnotatedCDS_$$projectName$$-$$projectVersion$$.fasta.desc</paramValue>
      <paramValue name="descripString">$$annotatedCDSDescripString$$</paramValue>
      <paramValue name="organismSource">$$genomeSource$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="genomeVirtualSeqsExtDbRlsSpec">$$genomeVirtualSeqsExtDbRlsSpec$$</paramValue>
      <paramValue name="deprecated">$$deprecated$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
    </step>

    <step name="formatAnnotatedCDSDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::FormatDownloadFile" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="inputFile">$$downloadSiteFastaDataDir$$/$$organismName$$AnnotatedCDS_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="outputDir">$$webServicesDataDir$$/blast</paramValue>
      <paramValue name="formattedFileName">$$organismName$$CDS</paramValue>
      <paramValue name="args">-n -t release-$$projectVersion$$/$$organismName$$CDS</paramValue>
    <depends name="makeAnnotatedCDSDownloadFile"/>
    </step>

    <step name="makeAnnotatedTranscriptsDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeAnnotatedTranscriptsDownloadFile" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="outputFile">$$downloadSiteFastaDataDir$$/$$organismName$$AnnotatedTranscripts_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="descripFile">$$downloadSiteFastaDataDir$$/.$$organismName$$AnnotatedTranscripts_$$projectName$$-$$projectVersion$$.fasta.desc</paramValue>
      <paramValue name="descripString">$$annotatedTranscriptsDescripString$$</paramValue>
      <paramValue name="organismSource">$$genomeSource$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="genomeVirtualSeqsExtDbRlsSpec">$$genomeVirtualSeqsExtDbRlsSpec$$</paramValue>
      <paramValue name="deprecated">$$deprecated$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
    </step>

    <step name="formatAnnotatedTranscriptDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::FormatDownloadFile" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="inputFile">$$downloadSiteFastaDataDir$$/$$organismName$$AnnotatedTranscripts_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="outputDir">$$webServicesDataDir$$/blast</paramValue>
      <paramValue name="formattedFileName">$$organismName$$Transcripts</paramValue>
      <paramValue name="args">-n -t release-$$projectVersion$$/$$organismName$$Transcripts</paramValue>
    <depends name="makeAnnotatedTranscriptsDownloadFile"/>
    </step>

    <step name="makeAnnotatedProteinsDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeAnnotatedProteinsDownloadFile" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="outputFile">$$downloadSiteFastaDataDir$$/$$organismName$$AnnotatedProteins_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="descripFile">$$downloadSiteFastaDataDir$$/.$$organismName$$AnnotatedProteins_$$projectName$$-$$projectVersion$$.fasta.desc</paramValue>
      <paramValue name="descripString">$$annotatedProteinsDescripString$$</paramValue>
      <paramValue name="organismSource">$$genomeSource$$</paramValue>
      <paramValue name="deprecated">$$deprecated$$</paramValue>
      <paramValue name="genomeExtDbSpecList">$$genomeExtDbRlsSpec$$,$$genomeVirtualSeqsExtDbRlsSpec$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
    </step>

    <step name="formatAnnotatedProteinsDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::FormatDownloadFile" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="inputFile">$$downloadSiteFastaDataDir$$/$$organismName$$AnnotatedProteins_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="outputDir">$$webServicesDataDir$$/blast</paramValue>
      <paramValue name="formattedFileName">$$organismName$$Proteins</paramValue>
      <paramValue name="args">-p -C X -t release-$$projectVersion$$/$$organismName$$Proteins</paramValue>
    <depends name="makeAnnotatedProteinsDownloadFile"/>
    </step>

    <step name="makeMixedGenomicDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeMixedGenomicDownloadFile" includeIf="$$makeGenomicDownloadFile$$">
      <paramValue name="outputFile">$$downloadSiteFastaDataDir$$/$$organismName$$Genomic_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="descripFile">$$downloadSiteFastaDataDir$$/.$$organismName$$Genomic_$$projectName$$-$$projectVersion$$.fasta.desc</paramValue>
      <paramValue name="descripString">$$mixedGenomicDescripString$$</paramValue>
      <paramValue name="organismSource">$$genomeSource$$</paramValue>
      <paramValue name="genomeExtDbSpecList">$$genomeExtDbRlsSpec$$,$$genomeVirtualSeqsExtDbRlsSpec$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
    </step>

    <step name="formatMixedGenomicDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::FormatDownloadFile" includeIf="$$makeGenomicDownloadFile$$">
      <paramValue name="inputFile">$$downloadSiteFastaDataDir$$/$$organismName$$Genomic_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="outputDir">$$webServicesDataDir$$/blast</paramValue>
      <paramValue name="formattedFileName">$$organismName$$Genomics</paramValue>
      <paramValue name="args">-n -t release-$$projectVersion$$/$$organismName$$Genomics</paramValue>
    <depends name="makeMixedGenomicDownloadFile"/>
    </step>

    <step name="makeDoubleStrandGenomicDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeGenomicDoubleStrandFile" includeIf="$$makeGenomicDownloadFile$$">
      <paramValue name="outputFile">$$downloadSiteFastaDataDir$$/$$organismName$$Genomic_doubleStrand_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="descripFile">$$downloadSiteFastaDataDir$$/.$$organismName$$Genomic_doubleStrand_$$projectName$$-$$projectVersion$$.fasta.desc</paramValue>
      <paramValue name="descripString">$$mixedGenomicDescripString$$</paramValue>
      <paramValue name="organismSource">$$genomeSource$$</paramValue>
      <paramValue name="genomeExtDbSpecList">$$genomeExtDbRlsSpec$$,$$genomeVirtualSeqsExtDbRlsSpec$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
    </step>

    <step name="makeOrfDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeOrfDownloadFile" includeIf="$$makeGenomicDownloadFile$$">
      <paramValue name="outputFile">$$downloadSiteFastaDataDir$$/$$organismName$$ORFs_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="descripFile">$$downloadSiteFastaDataDir$$/.$$organismName$$ORFs_$$projectName$$-$$projectVersion$$.fasta.desc</paramValue>
      <paramValue name="descripString">$$orfDescripString$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="genomeVirtualSeqsExtDbRlsSpec">$$genomeVirtualSeqsExtDbRlsSpec$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
      <paramValue name="minOrfLength">$$minOrfLength$$</paramValue>
    </step>

    <step name="formatOrfDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::FormatDownloadFile" includeIf="$$makeGenomicDownloadFile$$">
      <paramValue name="inputFile">$$downloadSiteFastaDataDir$$/$$organismName$$ORFs_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="outputDir">$$webServicesDataDir$$/blast</paramValue>
      <paramValue name="formattedFileName">$$organismName$$ORF</paramValue>
      <paramValue name="args">-p -C X -t release-$$projectVersion$$/$$organismName$$ORF</paramValue>
    <depends name="makeOrfDownloadFile"/>
    </step>

    <step name="makeOrfNADownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeOrfNADownloadFile" includeIf="$$makeGenomicDownloadFile$$">
      <paramValue name="outputFile">$$downloadSiteFastaDataDir$$/$$organismName$$ORFNAs_$$projectName$$-$$projectVersion$$.fasta</paramValue>
      <paramValue name="descripFile">$$downloadSiteFastaDataDir$$/.$$organismName$$ORFNAs_$$projectName$$-$$projectVersion$$.fasta.desc</paramValue>
      <paramValue name="descripString">$$orfNADescripString$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="genomeVirtualSeqsExtDbRlsSpec">$$genomeVirtualSeqsExtDbRlsSpec$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
      <paramValue name="minOrfLength">$$minOrfLength$$</paramValue>
    </step>

    <step name="makeInterproDownloadFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeInterproDownloadFile" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="outputFile">$$downloadSiteTxtDataDir$$/$$organismName$$Interpro_$$projectName$$-$$projectVersion$$.txt</paramValue>
      <paramValue name="descripFile">$$downloadSiteTxtDataDir$$/.$$organismName$$Interpro_$$projectName$$-$$projectVersion$$.txt.desc</paramValue>
      <paramValue name="descripString">$$interproDescripString$$</paramValue>
      <paramValue name="genomeExtDbRlsSpec">$$genomeExtDbRlsSpec$$</paramValue>
      <paramValue name="interproExtDbRlsSpec">InterproscanData_RSRC|@@InterproscanData_VER@@</paramValue>
      <paramValue name="projectDB">$$projectName$$</paramValue>
      <paramValue name="soTermIdsOrNames">$$soTermIdsOrNames$$</paramValue>
    </step>

    <step name="makeCodonUsage" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeCodonUsage" includeIf="$$makeProteomeDownloadFile$$">
      <paramValue name="inputFile">$$downloadSiteFastaDataDir$$/$$organismName$$AnnotatedCDS_$$projectName$$-$$projectVersion$$.fasta</paramValue>    
      <paramValue name="descripFile">$$downloadSiteTxtDataDir$$/.$$organismName$$AnnotatedCDS_$$projectName$$-$$projectVersion$$.fasta.desc</paramValue>    
      <paramValue name="descripString">$$codonDescripString$$</paramValue>    
      <paramValue name="outputFile">$$downloadSiteTxtDataDir$$/$$organismName$$CodonUsage_$$projectName$$-$$projectVersion$$.txt</paramValue>
    <depends name="makeAnnotatedCDSDownloadFile"/>
    </step>

    <step name="makeGeneAliasDescripFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDescripFile">
      <paramValue name="descripFile">$$downloadSiteTxtDataDir$$/.$$organismName$$GeneAlias_$$projectName$$-$$projectVersion$$.txt.desc</paramValue>    
      <paramValue name="descripString">$$geneAliasDescripString$$</paramValue>    
    </step>

    <step name="makeGeneDescripFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDescripFile">
      <paramValue name="descripFile">$$downloadSiteTxtDataDir$$/.$$organismName$$Gene_$$projectName$$-$$projectVersion$$.txt.desc</paramValue>    
      <paramValue name="descripString">$$geneDescripString$$</paramValue>    
    </step>

    <step name="makeSequenceDescripFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDescripFile">
      <paramValue name="descripFile">$$downloadSiteTxtDataDir$$/.$$organismName$$Sequence_$$projectName$$-$$projectVersion$$.txt.desc</paramValue>    
      <paramValue name="descripString">$$sequenceDescripString$$</paramValue>    
    </step>

    <step name="makeGffDescripFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeDescripFile">
      <paramValue name="descripFile">$$downloadSiteTxtDataDir$$/.$$organismName$$_$$projectName$$-$$projectVersion$$.gff.desc</paramValue>    
      <paramValue name="descripString">$$gffDescripString$$</paramValue>    
    </step>


    <step name="makeReadMeFile" stepClass="ApiCommonWorkflow::Main::WorkflowSteps::MakeReadMeFile">
      <paramValue name="baseDir">$$downloadSiteDataDir$$</paramValue>    
      <paramValue name="outputFile">$$downloadSiteDataDir$$/README.htaccess</paramValue>    
    <depends name="makeAnnotatedCDSDownloadFile"/>
    <depends name="makeESTDownloadFile"/>
    <depends name="makeDotsAssemblyDownloadFile"/>
    <depends name="makeAnnotatedCDSDownloadFile"/>
    <depends name="makeAnnotatedTranscriptsDownloadFile"/>
    <depends name="makeAnnotatedProteinsDownloadFile"/>
    <depends name="makeMixedGenomicDownloadFile"/>
    <depends name="makeOrfDownloadFile"/>
    <depends name="makeOrfNADownloadFile"/>
    <depends name="makeInterproDownloadFile"/>
    <depends name="makeCodonUsage"/>
    <depends name="makeGeneAliasDescripFile"/>
    <depends name="makeGeneDescripFile"/>
    <depends name="makeSequenceDescripFile"/>
    <depends name="makeGffDescripFile"/>
    </step>

</workflowGraph>
